{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport classNames from 'classnames';\nimport dynamic from 'next/dynamic';\nimport randomColor from 'randomcolor';\nimport { useEffect, useRef, useState } from 'react';\nimport { observer } from 'utils/mobx';\nimport { useStore } from '../../common/store';\nimport { isClientSide } from '../../utils/utils';\nconst Zmage = dynamic(() => import('react-zmage'), {\n  ssr: false,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak('react-zmage')],\n    modules: ['react-zmage']\n  }\n});\nconst LazyImage = dynamic(() => import('react-lazy-images').then(mo => mo.LazyImage), {\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak('react-lazy-images')],\n    modules: ['react-lazy-images']\n  }\n});\nconst Image = observer(({\n  src,\n  alt,\n  placeholderRef,\n  popup = false\n}) => {\n  const {\n    0: loaded,\n    1: setLoad\n  } = useState(false);\n  const {\n    appStore\n  } = useStore();\n  const isMobile = appStore.viewport.mobile;\n  useEffect(() => {\n    if (src) {\n      const image = new window.Image();\n      image.src = src;\n\n      image.onload = () => {\n        setLoad(true);\n\n        try {\n          if (placeholderRef && placeholderRef.current) {\n            placeholderRef.current.classList.add('hide');\n          } // if (wrapRef && wrapRef.current) {\n          //   wrapRef.current.style.height = ''\n          // }\n          // eslint-disable-next-line no-empty\n\n        } catch {}\n      };\n    }\n  }, [placeholderRef, src]);\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: classNames('lazyload-image', !loaded && 'image-hide')\n  }, popup ? isMobile ? __jsx(\"img\", {\n    src: src,\n    alt: alt,\n    onClick: () => {\n      window.open(src);\n    }\n  }) : __jsx(Zmage, {\n    src: src,\n    alt: alt,\n    backdrop: 'var(--light-bg)'\n  }) : __jsx(\"img\", {\n    src: src,\n    alt: alt\n  })));\n});\nexport const ImageLazy = observer(props => {\n  const {\n    defaultImage,\n    src,\n    alt = src,\n    height,\n    width,\n    useRandomBackgroundColor,\n    popup = false,\n    style\n  } = props,\n        rest = _objectWithoutProperties(props, [\"defaultImage\", \"src\", \"alt\", \"height\", \"width\", \"useRandomBackgroundColor\", \"popup\", \"style\"]);\n\n  const realImageRef = useRef(null);\n  const placeholderRef = useRef(null);\n  const wrapRef = useRef(null);\n  const colorMode = useStore().appStore.colorMode;\n  const {\n    0: randColor,\n    1: setRandColor\n  } = useState(randomColor({\n    luminosity: colorMode === 'light' ? 'bright' : 'dark'\n  }));\n  useEffect(() => {\n    setRandColor(randomColor({\n      luminosity: colorMode === 'light' ? 'light' : 'dark'\n    }));\n  }, [colorMode]);\n  return __jsx(\"div\", {\n    style: _objectSpread({}, style || {})\n  }, defaultImage ? __jsx(\"img\", _extends({\n    src: defaultImage,\n    alt: alt\n  }, rest, {\n    ref: realImageRef\n  })) : __jsx(\"div\", {\n    style: {\n      position: 'relative',\n      // overflow: 'hidden',\n      height,\n      width,\n      maxWidth: '100%',\n      margin: 'auto'\n    },\n    ref: wrapRef\n  }, __jsx(LazyImage, {\n    src: src,\n    alt: alt,\n    loadEagerly: !isClientSide(),\n    placeholder: ({\n      ref\n    }) => __jsx(\"div\", {\n      ref: ref\n    }),\n    actual: props => {\n      return __jsx(Image, _extends({\n        className: 'image-hide lazyload-image'\n      }, rest, {\n        src: src,\n        alt: alt,\n        popup: popup\n      }, {\n        placeholderRef\n      }, props));\n    },\n    observerProps: isClientSide() ? {\n      rootMargin: '100px'\n    } : undefined\n  }), __jsx(\"div\", {\n    className: classNames('placeholder-image', props.className),\n    ref: placeholderRef,\n    style: {\n      height,\n      width,\n      maxWidth: '100%',\n      position: 'absolute',\n      backgroundColor: useRandomBackgroundColor ? randColor : '',\n      filter: useRandomBackgroundColor && colorMode === 'dark' ? 'brightness(0.5)' : 'brightness(1.3)',\n      zIndex: -1\n    }\n  })), alt && alt.startsWith('!') && __jsx(\"p\", {\n    className: 'img-alt'\n  }, alt.slice(1)));\n});\nexport const ImageLazyWithPopup = props => {\n  const {\n    src,\n    alt,\n    height,\n    width\n  } = props,\n        rest = _objectWithoutProperties(props, [\"src\", \"alt\", \"height\", \"width\"]);\n\n  return __jsx(ImageLazy, _extends({\n    src: src,\n    alt: alt || src,\n    height: height,\n    width: width,\n    useRandomBackgroundColor: true,\n    popup: true\n  }, rest));\n};","map":null,"metadata":{},"sourceType":"module"}