{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\n\n/*\n * @Author: Innei\n * @Date: 2020-06-12 21:41:12\n * @LastEditTime: 2020-08-21 20:44:25\n * @LastEditors: Innei\n * @FilePath: /mx-web/components/Toc/index.tsx\n * @Coding with Love\n */\nimport isNull from 'lodash/isNull';\nimport range from 'lodash/range';\nimport throttle from 'lodash/throttle';\nimport dynamic from 'next/dynamic';\nimport QueueAnim from 'rc-queue-anim';\nimport { memo, useEffect, useRef, useState } from 'react';\nimport styles from './index.module.scss';\nexport var Toc = /*#__PURE__*/memo(function () {\n  var containerRef = useRef(null);\n\n  var _useState = useState([]),\n      headings = _useState[0],\n      setHeadings = _useState[1];\n\n  var setMaxWidth = throttle(function () {\n    if (containerRef.current) {\n      containerRef.current.style.maxWidth = document.documentElement.getBoundingClientRect().width - containerRef.current.getBoundingClientRect().x - 30 + 'px';\n    }\n  }, 14);\n  var getHeadings = throttle(function () {\n    var $write = document.getElementById('write');\n\n    if (!$write) {\n      return getHeadings();\n    }\n\n    setMaxWidth();\n    var $headings = range(1, 6).map(function (h) {\n      return Array.from($write.querySelectorAll('h' + h));\n    });\n\n    if (isNull(headings)) {\n      return;\n    }\n\n    if (headings.length === 0) {\n      // @ts-ignore\n      var _headings = $headings.flat(2).sort(function (a, b) {\n        return parseInt(a.id) - parseInt(b.id);\n      }).map(function (d) {\n        return d.id;\n      });\n\n      setHeadings(_headings.length === 0 ? null : _headings);\n    }\n  }, 20);\n  useEffect(function () {\n    try {\n      setTimeout(function () {\n        getHeadings();\n        window.addEventListener('resize', setMaxWidth);\n      }, 1000); // eslint-disable-next-line no-empty\n    } catch (_unused) {}\n\n    return function () {\n      window.removeEventListener('resize', setMaxWidth);\n    };\n  });\n  return __jsx(\"section\", {\n    className: \"paul-lister\",\n    style: {\n      zIndex: 3\n    }\n  }, __jsx(\"div\", {\n    className: \"container\",\n    ref: containerRef\n  }, __jsx(QueueAnim, null, headings && headings.map(function (heading, i) {\n    return __jsx(\"a\", {\n      \"data-scroll\": true,\n      href: '#' + heading,\n      key: i,\n      className: styles['toc-link'],\n      onClick: function onClick(e) {\n        if (typeof window.SmoothScroll === 'undefined') {\n          e.preventDefault();\n          var el = document.getElementById(heading);\n          el === null || el === void 0 ? void 0 : el.scrollIntoView({\n            behavior: 'smooth'\n          });\n        }\n      }\n    }, __jsx(\"span\", {\n      className: styles['a-pointer']\n    }, heading.slice(heading.indexOf('ยก') + 1)));\n  }))));\n});\nexport default dynamic(function () {\n  return import('.').then(function (m) {\n    return m.Toc;\n  });\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('.')];\n    },\n    modules: ['.']\n  }\n});","map":null,"metadata":{},"sourceType":"module"}