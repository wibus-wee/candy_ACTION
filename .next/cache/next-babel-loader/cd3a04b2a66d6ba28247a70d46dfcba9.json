{"ast":null,"code":"var __jsx = React.createElement;\nimport { useStore } from 'common/store';\nimport { Error } from 'components/Error';\nimport Markdown from 'components/MD-render';\nimport OutdateNotice from 'components/Outdate';\nimport { Core } from 'core';\nimport dayjs from 'dayjs';\nimport { ArticleLayout } from 'layouts/ArticleLayout';\nimport { useRouter } from 'next/router';\nimport React, { useEffect, useState } from 'react';\nimport { observer } from 'utils/mobx';\nimport { getSummaryFromMd } from 'utils/utils';\nimport { Copyright } from '../../components/Copyright';\nimport { Seo } from '../../components/SEO';\nimport configs from '../../configs';\nexport const PostView = props => {\n  const {\n    content,\n    title,\n    slug\n  } = props;\n  const {\n    0: copyrightInfo,\n    1: setCopyright\n  } = useState({});\n  const description = getSummaryFromMd(props.content).slice(0, 150);\n  useEffect(() => {\n    window.scrollTo({\n      top: 0,\n      behavior: 'smooth'\n    });\n  }, [props]);\n  const {\n    appStore\n  } = useStore();\n  useEffect(() => {\n    appStore.headerNav = {\n      title: props.title,\n      meta: '文章',\n      show: true\n    };\n    return () => {\n      appStore.headerNav.show = false;\n    };\n  }, [appStore, props.title]);\n  useEffect(() => {\n    setCopyright({\n      date: dayjs(props.modified).format('YYYY年MM月DD日 H:mm'),\n      title,\n      link: new URL(location.pathname, configs.url).toString()\n    });\n  }, [props, title]);\n  const router = useRouter();\n\n  if (!router.isFallback && !slug) {\n    return __jsx(Error, {\n      statusCode: 404\n    });\n  }\n\n  return __jsx(ArticleLayout, {\n    title: title\n  }, __jsx(Seo, {\n    title: props.title,\n    description: description,\n    openGraph: {\n      type: 'article',\n      article: {\n        publishedTime: props.created.toString(),\n        modifiedTime: props.modified.toString()\n      }\n    }\n  }), __jsx(OutdateNotice, {\n    time: props.modified\n  }), __jsx(Markdown, {\n    value: content,\n    escapeHtml: false,\n    showTOC: true\n  }), __jsx(Copyright, copyrightInfo));\n};\nexport const getStaticProps = async (context) => {\n  const {\n    params\n  } = context;\n  const {\n    slug\n  } = params;\n  const post = Core.fetcher.getPostBySlug(slug);\n  return {\n    props: post || {}\n  };\n};\nexport const getStaticPaths = async () => {\n  const paths = Core.fetcher.articles.getKeys().map(k => {\n    return {\n      params: {\n        slug: k\n      }\n    };\n  });\n  return {\n    paths,\n    fallback: false\n  };\n};\nexport default observer(PostView);","map":null,"metadata":{},"sourceType":"module"}